---
title: "Trypanosoma Analysis"
output: pdf_document
---

```{r}
###################################################################################################################################
#Read in data
###################################################################################################################################

#read in real RNA-Seq data from Schultz
library(DESeq2)
library(tidyverse)
#read in data and clean
setwd('/Users/ethanashby/Desktop')
tccount<-read.table("full_read_counts_Tryp.txt", header=TRUE) %>% select(-ib_3h_1)
tccount<- tccount %>% dplyr::distinct(gene, .keep_all=TRUE)
rownames(tccount)<-tccount$gene
tccount<-tccount[,2:30]
tccount<-tccount[rowSums(tccount)>0,]

###################################################################################################################################
#DESeq2
###################################################################################################################################
design<-data.frame(time=as.factor(c(rep("0h", 3), rep("3h", 2), rep("6h", 3), rep("12h", 3), rep("24h",3), rep("48h",3), rep("3d",3), rep("7d",3), rep("10d",3), rep("14d",3))), rep=as.factor(c(rep(1:3), rep(1:2), rep(1:3, 8))))

times<-c(rep(0,3),rep(3,2),rep(6,3),rep(12,3),rep(24,3),rep(48,3),rep(72,3),rep(168,3),rep(240,3),rep(336,3))

#create DESeqDataSet Object
ddstcCountTable <- DESeqDataSetFromMatrix(
  countData = tccount,
  colData = design,
  design = ~ time + rep)

#Run DESeq2
trypdds<-DESeq(ddstcCountTable)

res<-results(trypdds, contrast=c("time", "0h", "12h"))
res$gene<-rownames(res)
sigres<-res[which(res$padj<0.01),]

```

